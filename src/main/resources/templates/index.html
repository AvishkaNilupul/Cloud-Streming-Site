<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <!-- for testing -->
    <link rel="stylesheet" href="../static/css/style.css">
    
    <title>Reactive Spring Video streaming</title>


</head>
<body>   
     <!-- NavBar -->
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand ps-5 ms-5">
            <h2>RexFlix</h2></a>
        <div class=" d-flex col-9 ms-3">        

            <div class=""><button class="b1"><h5>Trending</h5></button></div>
            <div class="ms-4"><button class="b1"><h5>Anime</h5></button></div>
            <div class="ms-4"><button class="b1"><h5>Movies</h5></button></div>
            <div class="ms-4"><button class="b1"><h5>Series</h5></button></div>
            <div class="ms-4"><button class="b1"><h5>Gerne</h5></button></div>
            <div class="ms-4"><button class="b1"><h5>NEW</h5></button></div>

        </div>
        <div class="dropdown col-2">

              <div type="button" data-bs-toggle="dropdown" aria-expanded="false" class="round"></div>

            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Action</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>
          </div>
      </nav>
    <!-- NavBar -->

      <div class="wallp">
        <img src="https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="img-fluid wall mt-5" alt="Responsive image">
        <div class="centered">
            <div class="input-group rounded">
            <input type="search" class="form-control rounded" placeholder="Search" aria-label="Search" aria-describedby="search-addon" />
            <span class="input-group-text border-0" id="search-addon">
              <i class="fas fa-search"></i>
            </span>
          </div></div>
        <div class="centered2">Discover the Best of RexFlix</div>
        <div class="centered23">Explore thousands of movies and TV shows just for you!</div>
        
      </div>




      
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable ">
      <div class="modal-content">
        <div class="modal-body colorss">
            <div class="container-fluid">
                <div class=" row">
                    <div class="b1 col-6">
                        <img id="modelimg"  src="..." class="modelimg" alt="...">
                    </div>
    
                    <div class="b1 col-6">
    
                        <h5 class="modal-title text-center" id="exampleModalLabel">Modal title</h5>
                        <div class="mt-5">
                            description
                        </div>
                        <div class="scrollable-div " id="crollable-div">
                            
                        </div>
                    </div>
                </div>
            </div>


        </div>
      </div>
    </div>
  </div>
  




  
    <!-- Trending -->
      <div class=" mt-5 ms-5 ps-5">
        <h3 class="" >Trending</h>
      </div>

<div class="contain d-flex flex-row flex-wrap justify-content-start">
    <div th:each="trending, movieIndex : ${trending}" class="box"  data-bs-toggle="modal" data-bs-target="#exampleModal">
        <img id="trendingImg" th:src="${trending.image}">
        
        <div class="subm ">
            
            <h5 class="card-title" id="title" th:text="${trending.name}">Movie Title</h5>
            <!-- <p class="play">
                
                <button class="b1" >
                    <i class="fa-solid fa-heart " ></i>

                </button>
                <button class="b1" > 
                    <i class="fa-solid fa-play ms-2"></i>
                </button>

            </p> -->

            
        </div>
    </div>
</div>



          <!-- Anime -->
          <div class=" ms-5 ps-5">
            <h3 class="moviess">Anime</h>
          </div>
    
    <div class="contain d-flex flex-row flex-wrap justify-content-start">
        <div th:each="anime, movieIndex : ${anime}" class="box">
            <img th:src="${anime.image}">
            
            <div class="subm ">
                
                <h5 class="card-title" id="title" th:text="${anime.name}">Movie Title</h5>
                <p class="play">
                    
                    <button class="b1">
                        <i class="fa-solid fa-heart " ></i>
    
                    </button>
                    <button class="b1" > 
                        <i class="fa-solid fa-play ms-2"></i>
                    </button>
    
                </p>
    
                
            </div>
        </div>
    </div>
    
        <!-- Anime -->

        <!-- Movies -->
        <div class=" ms-5 ps-5">
            <h3 class="moviess">Movies</h>
          </div>
    
    <div class="contain d-flex flex-row flex-wrap justify-content-start">
        <div th:each="movie, movieIndex : ${movies}" class="box b22">
            <img th:src="${movie.image}">
            
            <div class="subm ">
                
                <h5 class="card-title" id="titlex" th:text="${movie.name}">Movie Title</h5>
                <p class="play">
                    
                    <button class="b1 b2">
                        <i class="fa-solid fa-heart " ></i>
    
                    </button>
                    <button class="b1 b2"> 
                        <i class="fa-solid fa-play ms-2"></i>
                    </button>
    
                </p>
    
                
            </div>
        </div>
    </div>




        <!-- Movies -->


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
        crossorigin="anonymous">
        </script>

        <script>


    document.querySelectorAll('.box').forEach(item => {
    item.addEventListener('click', event => {
        var title = item.closest('.box').querySelector('.card-title').innerText;
        document.getElementById("exampleModalLabel").innerText = title;
        var treding = item.querySelector('img').getAttribute('src');
        document.getElementById('modelimg').setAttribute('src',treding);
        
        
        
    });
});







</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll('.box').forEach(item => {
        item.addEventListener('click', event => {
            var title = item.closest('.box').querySelector('.card-title').innerText;

            fetch("api/trending/" + title)
                .then((response) => response.json())
                .then((data) => {

                    const check = data[0];

                    if(check.genres === "anime" ){
                        var cardHtml = "";
                    data.forEach((item) => {
                        cardHtml += `

                            <div class="card mb-3 mt-5" style="max-width: 540px;">
                                <div class="row g-0">
                                    <div class="col-md-4">
                                        <img src="${item.image}" class="img-fluid rounded-start" alt="${item.name}">
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card-body">
                                            <h5 class="card-title">${item.name}</h5>
                                            <h6>${item.episode}</h6>
                                            <button type="button" class="btn btn-primary play-button" data-title="${item.name}" data-episode="${item.episode}">Play</button>
                                        </div>
                                    </div>
                                </div>
                            </div>`;
                            
                    document.getElementById("crollable-div").innerHTML = cardHtml;

                    document.querySelectorAll('.play-button').forEach(button => {
                    button.addEventListener('click', function() {
                    const title = this.getAttribute('data-title');
                    const episode = this.getAttribute('data-episode');
                    window.location.href = `/watch?title=${encodeURIComponent(title)}&episode=${encodeURIComponent(episode)}`;
                        });
                    });
                    })
                        
                    }else{
                        var cardHtml = "";
                        data.forEach((item) => {
                        cardHtml += `
                        <button type="button" class="btn btn-primary play-button">Play</button>`;
                        
                    document.getElementById("crollable-div").innerHTML = cardHtml;

                    document.querySelectorAll('.play-button').forEach(button => {
                    button.addEventListener('click', function() {

                    const episode = this.getAttribute('data-episode');
                    window.location.href = `/watch?title=${encodeURIComponent(title)}&genres=${encodeURIComponent("movie")}`;
                        });
                    });
                    })
                    }
                
                    ;

                })
                .catch((error) => console.error("Error:", error));
        });
    });
});


  </script>
      


</body>
</html>